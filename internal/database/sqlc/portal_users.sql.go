// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: portal_users.sql

package sqlc

import (
	"context"
	"database/sql"
)

const countAdminUsers = `-- name: CountAdminUsers :one
SELECT COUNT(*) FROM portal_users WHERE is_admin = 1
`

func (q *Queries) CountAdminUsers(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countAdminUsers)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countEnabledPortalUsers = `-- name: CountEnabledPortalUsers :one
SELECT COUNT(*) FROM portal_users WHERE enabled = 1
`

func (q *Queries) CountEnabledPortalUsers(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countEnabledPortalUsers)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countPortalUsers = `-- name: CountPortalUsers :one
SELECT COUNT(*) FROM portal_users
`

func (q *Queries) CountPortalUsers(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countPortalUsers)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createAdminUser = `-- name: CreateAdminUser :one
INSERT INTO portal_users (
    username, password_hash, display_name, is_admin, auto_approve, enabled
) VALUES (?, ?, ?, 1, 1, 1)
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type CreateAdminUserParams struct {
	Username     string         `json:"username"`
	PasswordHash string         `json:"password_hash"`
	DisplayName  sql.NullString `json:"display_name"`
}

func (q *Queries) CreateAdminUser(ctx context.Context, arg CreateAdminUserParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, createAdminUser, arg.Username, arg.PasswordHash, arg.DisplayName)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const createPortalUser = `-- name: CreatePortalUser :one
INSERT INTO portal_users (
    username, password_hash, display_name, quality_profile_id, auto_approve, enabled
) VALUES (?, ?, ?, ?, ?, ?)
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type CreatePortalUserParams struct {
	Username         string         `json:"username"`
	PasswordHash     string         `json:"password_hash"`
	DisplayName      sql.NullString `json:"display_name"`
	QualityProfileID sql.NullInt64  `json:"quality_profile_id"`
	AutoApprove      int64          `json:"auto_approve"`
	Enabled          int64          `json:"enabled"`
}

func (q *Queries) CreatePortalUser(ctx context.Context, arg CreatePortalUserParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, createPortalUser,
		arg.Username,
		arg.PasswordHash,
		arg.DisplayName,
		arg.QualityProfileID,
		arg.AutoApprove,
		arg.Enabled,
	)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const createPortalUserWithID = `-- name: CreatePortalUserWithID :one
INSERT INTO portal_users (
    id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, is_admin
) VALUES (?, ?, ?, ?, ?, ?, ?, ?)
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type CreatePortalUserWithIDParams struct {
	ID               int64          `json:"id"`
	Username         string         `json:"username"`
	PasswordHash     string         `json:"password_hash"`
	DisplayName      sql.NullString `json:"display_name"`
	QualityProfileID sql.NullInt64  `json:"quality_profile_id"`
	AutoApprove      int64          `json:"auto_approve"`
	Enabled          int64          `json:"enabled"`
	IsAdmin          int64          `json:"is_admin"`
}

// Used for copying users to dev database while preserving IDs
func (q *Queries) CreatePortalUserWithID(ctx context.Context, arg CreatePortalUserWithIDParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, createPortalUserWithID,
		arg.ID,
		arg.Username,
		arg.PasswordHash,
		arg.DisplayName,
		arg.QualityProfileID,
		arg.AutoApprove,
		arg.Enabled,
		arg.IsAdmin,
	)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const deletePortalUser = `-- name: DeletePortalUser :exec
DELETE FROM portal_users WHERE id = ?
`

func (q *Queries) DeletePortalUser(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, deletePortalUser, id)
	return err
}

const getAdminUser = `-- name: GetAdminUser :one
SELECT id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin FROM portal_users WHERE is_admin = 1 LIMIT 1
`

func (q *Queries) GetAdminUser(ctx context.Context) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, getAdminUser)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const getPortalUser = `-- name: GetPortalUser :one
SELECT id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin FROM portal_users WHERE id = ? LIMIT 1
`

func (q *Queries) GetPortalUser(ctx context.Context, id int64) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, getPortalUser, id)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const getPortalUserByUsername = `-- name: GetPortalUserByUsername :one
SELECT id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin FROM portal_users WHERE username = ? LIMIT 1
`

func (q *Queries) GetPortalUserByUsername(ctx context.Context, username string) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, getPortalUserByUsername, username)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const listEnabledPortalUsers = `-- name: ListEnabledPortalUsers :many
SELECT id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin FROM portal_users WHERE enabled = 1 ORDER BY display_name
`

func (q *Queries) ListEnabledPortalUsers(ctx context.Context) ([]*PortalUser, error) {
	rows, err := q.db.QueryContext(ctx, listEnabledPortalUsers)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []*PortalUser{}
	for rows.Next() {
		var i PortalUser
		if err := rows.Scan(
			&i.ID,
			&i.Username,
			&i.PasswordHash,
			&i.DisplayName,
			&i.QualityProfileID,
			&i.AutoApprove,
			&i.Enabled,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.IsAdmin,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listPortalUsers = `-- name: ListPortalUsers :many
SELECT id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin FROM portal_users ORDER BY created_at DESC
`

func (q *Queries) ListPortalUsers(ctx context.Context) ([]*PortalUser, error) {
	rows, err := q.db.QueryContext(ctx, listPortalUsers)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []*PortalUser{}
	for rows.Next() {
		var i PortalUser
		if err := rows.Scan(
			&i.ID,
			&i.Username,
			&i.PasswordHash,
			&i.DisplayName,
			&i.QualityProfileID,
			&i.AutoApprove,
			&i.Enabled,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.IsAdmin,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updatePortalUser = `-- name: UpdatePortalUser :one
UPDATE portal_users SET
    username = ?,
    display_name = ?,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type UpdatePortalUserParams struct {
	Username    string         `json:"username"`
	DisplayName sql.NullString `json:"display_name"`
	ID          int64          `json:"id"`
}

func (q *Queries) UpdatePortalUser(ctx context.Context, arg UpdatePortalUserParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, updatePortalUser, arg.Username, arg.DisplayName, arg.ID)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const updatePortalUserAutoApprove = `-- name: UpdatePortalUserAutoApprove :one
UPDATE portal_users SET
    auto_approve = ?,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type UpdatePortalUserAutoApproveParams struct {
	AutoApprove int64 `json:"auto_approve"`
	ID          int64 `json:"id"`
}

func (q *Queries) UpdatePortalUserAutoApprove(ctx context.Context, arg UpdatePortalUserAutoApproveParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, updatePortalUserAutoApprove, arg.AutoApprove, arg.ID)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const updatePortalUserEnabled = `-- name: UpdatePortalUserEnabled :one
UPDATE portal_users SET
    enabled = ?,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type UpdatePortalUserEnabledParams struct {
	Enabled int64 `json:"enabled"`
	ID      int64 `json:"id"`
}

func (q *Queries) UpdatePortalUserEnabled(ctx context.Context, arg UpdatePortalUserEnabledParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, updatePortalUserEnabled, arg.Enabled, arg.ID)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}

const updatePortalUserPassword = `-- name: UpdatePortalUserPassword :exec
UPDATE portal_users SET
    password_hash = ?,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?
`

type UpdatePortalUserPasswordParams struct {
	PasswordHash string `json:"password_hash"`
	ID           int64  `json:"id"`
}

func (q *Queries) UpdatePortalUserPassword(ctx context.Context, arg UpdatePortalUserPasswordParams) error {
	_, err := q.db.ExecContext(ctx, updatePortalUserPassword, arg.PasswordHash, arg.ID)
	return err
}

const updatePortalUserQualityProfile = `-- name: UpdatePortalUserQualityProfile :one
UPDATE portal_users SET
    quality_profile_id = ?,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?
RETURNING id, username, password_hash, display_name, quality_profile_id, auto_approve, enabled, created_at, updated_at, is_admin
`

type UpdatePortalUserQualityProfileParams struct {
	QualityProfileID sql.NullInt64 `json:"quality_profile_id"`
	ID               int64         `json:"id"`
}

func (q *Queries) UpdatePortalUserQualityProfile(ctx context.Context, arg UpdatePortalUserQualityProfileParams) (*PortalUser, error) {
	row := q.db.QueryRowContext(ctx, updatePortalUserQualityProfile, arg.QualityProfileID, arg.ID)
	var i PortalUser
	err := row.Scan(
		&i.ID,
		&i.Username,
		&i.PasswordHash,
		&i.DisplayName,
		&i.QualityProfileID,
		&i.AutoApprove,
		&i.Enabled,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.IsAdmin,
	)
	return &i, err
}
